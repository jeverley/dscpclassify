config global 'global'
	option class_bulk 'le'
	option class_high_throughput 'af13'
	option client_hints '1'
	option threaded_client_min_bytes '10000'
	option threaded_service_min_bytes '1000000'
	option wmm '0'

config ipset
	option name 'xcloud'
	option interval '1'
	list entry '13.104.0.0/14' # Western Europe

config ipset
	option name 'xcloud6'
	option family 'ipv6'
	option interval '1'
	list entry '2603:1000::/24' # Western Europe

config ipset
	option name 'zoom_meet'
	option family 'ipv4'
	option interval '1'
	list entry '3.7.35.0/25'
	list entry '3.235.82.0/23'
	list entry '3.235.96.0/23'
	list entry '4.34.125.128/25'
	list entry '4.35.64.128/25'
	list entry '8.5.128.0/23'
	list entry '15.220.80.0/24'
	list entry '15.220.81.0/25'
	list entry '18.254.23.128/25'
	list entry '18.254.61.0/25'
	list entry '20.203.158.80/28'
	list entry '20.203.190.192/26'
	list entry '50.239.202.0/23'
	list entry '50.239.204.0/24'
	list entry '52.61.100.128/25'
	list entry '64.125.62.0/24'
	list entry '64.211.144.0/24'
	list entry '64.224.32.0/19'
	list entry '65.39.152.0/24'
	list entry '69.174.57.0/24'
	list entry '69.174.108.0/22'
	list entry '101.36.167.0/24'
	list entry '101.36.170.0/23'
	list entry '103.122.166.0/23'
	list entry '111.33.115.0/25'
	list entry '111.33.181.0/25'
	list entry '115.110.154.192/26'
	list entry '115.114.56.192/26'
	list entry '115.114.115.0/26'
	list entry '115.114.131.0/26'
	list entry '120.29.148.0/24'
	list entry '121.244.146.0/27'
	list entry '134.224.0.0/16'
	list entry '137.66.128.0/17 '
	list entry '144.195.0.0/16'
	list entry '147.124.96.0/19'
	list entry '149.137.0.0/17'
	list entry '156.45.0.0/17'
	list entry '159.124.0.0/16'
	list entry '160.1.56.128/25'
	list entry '161.199.136.0/22'
	list entry '162.12.232.0/22'
	list entry '162.255.36.0/22'
	list entry '165.254.88.0/23'
	list entry '166.108.64.0/18'
	list entry '168.140.0.0/17 '
	list entry '170.114.0.0/16'
	list entry '173.231.80.0/20'
	list entry '192.204.12.0/22'
	list entry '198.251.128.0/17'
	list entry '202.177.207.128/27'
	list entry '203.200.219.128/27'
	list entry '204.80.104.0/21'
	list entry '204.141.28.0/22'
	list entry '206.247.0.0/16'
	list entry '207.226.132.0/24'
	list entry '209.9.211.0/24'
	list entry '209.9.215.0/24'
	list entry '213.19.144.0/24'
	list entry '213.19.153.0/24'
	list entry '213.244.140.0/24'
	list entry '221.122.63.0/24'
	list entry '221.122.64.0/24'
	list entry '221.122.88.64/27'
	list entry '221.122.88.128/25'
	list entry '221.122.89.128/25'
	list entry '221.123.139.192/27'

config ipset
	option name 'zoom_meet6'
	option family 'ipv6'
	option interval '1'
	list entry '2407:30C0::/32'
	list entry '2600:9000:2600::/48'
	list entry '2620:123:2000::/40'

config ipset
	option name 'zoom_phone'
	option family 'ipv4'
	option interval '1'
	list entry '8.5.128.0/24'
	list entry '64.211.144.0/24'
	list entry '64.224.32.0/19'
	list entry '65.39.152.0/24'
	list entry '69.174.57.0/24'
	list entry '101.36.167.0/24'
	list entry '103.122.166.0/23'
	list entry '120.29.148.0/24'
	list entry '137.66.128.0/17'
	list entry '144.195.0.0/16'
	list entry '147.124.96.0/19'
	list entry '149.137.0.0/17'
	list entry '156.45.0.0/17'
	list entry '159.124.0.0/16'
	list entry '162.12.232.0/22'
	list entry '170.114.0.0/16'
	list entry '173.231.92.0/24'
	list entry '173.231.94.0/24'
	list entry '192.204.12.0/22'
	list entry '206.247.0.0/16'
	list entry '209.9.211.0/24'
	list entry '209.9.215.0/24'
	list entry '213.19.144.0/24'
	list entry '213.19.153.0/24'
	list entry '213.244.140.0/24'
	list entry '221.122.63.0/24'

config ipset
	option name 'zoom_phone6'
	option interval '1'
	option family 'ipv6'
	list entry '2620:123:2000::/40'

config rule
	option name 'Zoom Meetings and Webinars TCP'
	option family 'ipv4'
	list proto 'tcp'
	list dest_port '443'
	list dest_port '8801-8802'
	list dest_ip '@zoom_meet'
	option class 'af41'

config rule
	option name 'Zoom Meetings and Webinars TCP IPv6'
	option family 'ipv6'
	list proto 'tcp'
	list dest_port '443'
	list dest_port '8801-8802'
	list dest_ip '@zoom_meet6'
	option class 'af41'

config rule
	option name 'Zoom Meetings and Webinars UDP'
	option family 'ipv4'
	list proto 'udp'
	list dest_port '3478-3479'
	list dest_port '8801-8810'
	list dest_ip '@zoom_meet'
	option class 'af41'

config rule
	option name 'Zoom Meetings and Webinars UDP IPv6'
	option family 'ipv6'
	list proto 'udp'
	list dest_port '3478-3479'
	list dest_port '8801-8810'
	list dest_ip '@zoom_meet6'
	option class 'af41'

config rule
	option name 'Zoom Phone TCP'
	option family 'ipv4'
	list proto 'tcp'
	list dest_port '443'
	list dest_port '5091'
	list dest_ip '@zoom_phone'
	option class 'af41'

config rule
	option name 'Zoom Phone TCP IPv6'
	option family 'ipv6'
	list proto 'tcp'
	list dest_port '443'
	list dest_port '5091'
	list dest_ip '@zoom_phone6'
	option class 'af41'

config rule
	option name 'Zoom Phone UDP'
	option family 'ipv4'
	list proto 'udp'
	list dest_port '20000-64000'
	list dest_ip '@zoom_phone'
	option class 'ef'

config rule
	option name 'Zoom Phone UDP IPv6'
	option family 'ipv6'
	list proto 'udp'
	list dest_port '20000-64000'
	list dest_ip '@zoom_phone6'
	option class 'ef'

config rule
	option name 'DNS'
	list proto 'tcp'
	list proto 'udp'
	list dest_port '53'
	list dest_port '853'
	list dest_port '5353'
	option class 'cs5'

config rule
	option name 'DoH'
	list proto 'tcp'
	list proto 'udp'
	list dest_ip '8.8.8.8'				# Google
	list dest_ip '8.8.4.4'				# Google
	list dest_ip '1.1.1.1'				# Cloudflare
	list dest_ip '1.0.0.1'				# Cloudflare
	list dest_ip '9.9.9.9'				# Quad9 Secured
	list dest_ip '149.112.112.112'		# Quad9 Secured
	list dest_ip '9.9.9.11'				# Quad9 Secured w/ECS
	list dest_ip '149.112.112.11'		# Quad9 Secured w/ECS
	list dest_ip '94.140.14.0/24'		# AdGuard
	list dest_ip '2001:4860:4860::8888' # Google
	list dest_ip '2001:4860:4860::8844' # Google
	list dest_ip '2606:4700:4700::1111' # Cloudflare
	list dest_ip '2606:4700:4700::1001' # Cloudflare
	list dest_ip '2620:fe::fe'			# Quad9 Secured
	list dest_ip '2620:fe::9'			# Quad9 Secured
	list dest_ip '2620:fe::11'			# Quad9 Secured w/ECS
	list dest_ip '2620:fe::fe:11'		# Quad9 Secured w/ECS
	list dest_ip '2a10:50c0::ad1:ff'	# AdGuard
	list dest_ip '2a10:50c0::ad2:ff'	# AdGuard
	list dest_ip '2a10:50c0::ded:ff'	# AdGuard Dedicated
	list dest_port '443'
	option class 'cs5'

config rule
	option name 'BOOTP/DHCP'
	option proto 'udp'
	list dest_port '67'
	list dest_port '68'
	option class 'cs5'

config rule
	option name 'NTP'
	option proto 'udp'
	option dest_port '123'
	option class 'cs5'

config rule
	option name 'SSH'
	option proto 'tcp'
	option dest_port '22'
	option class 'cs2'

config rule
	option name 'Xbox Cloud Gaming'
	option proto 'udp'
	option family 'ipv4'
	list dest_ip '@xcloud'
	list dest_port '1000-1150'
	list dest_port '9002'
	option class 'af41'

config rule
	option name 'Xbox Cloud Gaming IPv6'
	option proto 'udp'
	option family 'ipv6'
	list dest_ip '@xcloud6'
	list dest_port '1000-1150'
	list dest_port '9002'
	option class 'af41'

config rule
	option name 'Microsoft Teams voice'
	option proto 'udp'
	option src_port '50000-50019'
	option dest_port '3478-3481'
	list dest_ip '13.107.64.0/18'
	list dest_ip '52.112.0.0/14'
	list dest_ip '52.122.0.0/15'
	list dest_ip '2603:1063::/39'
	option class 'ef'

config rule
	option name 'Microsoft Teams video'
	option proto 'udp'
	option src_port '50020-50039'
	option dest_port '3478-3481'
	list dest_ip '13.107.64.0/18'
	list dest_ip '52.112.0.0/14'
	list dest_ip '52.122.0.0/15'
	list dest_ip '2603:1063::/39'
	option class 'af41'

config rule
	option name 'Microsoft Teams sharing'
	option proto 'udp'
	option src_port '50040-50059'
	option dest_port '3478-3481'
	list dest_ip '13.107.64.0/18'
	list dest_ip '52.112.0.0/14'
	list dest_ip '52.122.0.0/15'
	list dest_ip '2603:1063::/39'
	option class 'af21'

config rule
	option name 'ICMP'
	list proto 'icmp'
	list proto 'icmpv6'
	option class 'cs5'
	option enabled '0'

config rule # A rule which marks all non-HTTP UDP connections from a specific IP as cs4 and count new connection matches
	option name 'Game Console non-HTTP'
	option proto 'udp'
	list src_ip '192.168.1.100'
	list dest_port '!80'
	list dest_port '!443'
	option class 'cs4'
	option counter '1'
	option enabled '0'
