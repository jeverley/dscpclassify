config service
	option wmm_mark_lan '0'

config client_class_adoption
	option enabled '1'
	list exclude_class 'cs6'
	list exclude_class 'cs7'

config bulk_client_detection
	option enabled '1'
	option min_bytes '10000'
	option min_connections '10'

config high_throughput_service_detection
	option enabled '1'
	option min_bytes '1000000'
	option min_connections '3'

config ipset
	option name 'ms_teams'
	list entry '13.107.64.0/18'
	list entry '52.112.0.0/14'
	list entry '52.122.0.0/15'

config ipset
	option name 'ms_teams6'
	option family 'ipv6'
	list entry '2603:1063::/39'

config ipset
	option name 'xcloud'
	list entry '13.104.0.0/14' # Western Europe
		
config ipset
	option name 'GeForceNOWIPv4'
	option interval '1'
	list entry '80.84.160.0/20' # EU ASN AS50889
	
config ipset
	option name 'xcloud6'
	option family 'ipv6'
	list entry '2603:1000::/24' # Western Europe

config ipset
	option name 'zoom_meet'
	option family 'ipv4'
	list entry '3.7.35.0/25'
	list entry '3.235.82.0/23'
	list entry '3.235.96.0/23'
	list entry '4.34.125.128/25'
	list entry '4.35.64.128/25'
	list entry '8.5.128.0/23'
	list entry '15.220.80.0/24'
	list entry '15.220.81.0/25'
	list entry '18.254.23.128/25'
	list entry '18.254.61.0/25'
	list entry '20.203.158.80/28'
	list entry '20.203.190.192/26'
	list entry '50.239.202.0/23'
	list entry '50.239.204.0/24'
	list entry '52.61.100.128/25'
	list entry '64.125.62.0/24'
	list entry '64.211.144.0/24'
	list entry '64.224.32.0/19'
	list entry '65.39.152.0/24'
	list entry '69.174.57.0/24'
	list entry '69.174.108.0/22'
	list entry '101.36.167.0/24'
	list entry '101.36.170.0/23'
	list entry '103.122.166.0/23'
	list entry '111.33.115.0/25'
	list entry '111.33.181.0/25'
	list entry '115.110.154.192/26'
	list entry '115.114.56.192/26'
	list entry '115.114.115.0/26'
	list entry '115.114.131.0/26'
	list entry '120.29.148.0/24'
	list entry '121.244.146.0/27'
	list entry '134.224.0.0/16'
	list entry '137.66.128.0/17 '
	list entry '144.195.0.0/16'
	list entry '147.124.96.0/19'
	list entry '149.137.0.0/17'
	list entry '156.45.0.0/17'
	list entry '159.124.0.0/16'
	list entry '160.1.56.128/25'
	list entry '161.199.136.0/22'
	list entry '162.12.232.0/22'
	list entry '162.255.36.0/22'
	list entry '165.254.88.0/23'
	list entry '166.108.64.0/18'
	list entry '168.140.0.0/17 '
	list entry '170.114.0.0/16'
	list entry '173.231.80.0/20'
	list entry '192.204.12.0/22'
	list entry '198.251.128.0/17'
	list entry '202.177.207.128/27'
	list entry '203.200.219.128/27'
	list entry '204.80.104.0/21'
	list entry '204.141.28.0/22'
	list entry '206.247.0.0/16'
	list entry '207.226.132.0/24'
	list entry '209.9.211.0/24'
	list entry '209.9.215.0/24'
	list entry '213.19.144.0/24'
	list entry '213.19.153.0/24'
	list entry '213.244.140.0/24'
	list entry '221.122.63.0/24'
	list entry '221.122.64.0/24'
	list entry '221.122.88.64/27'
	list entry '221.122.88.128/25'
	list entry '221.122.89.128/25'
	list entry '221.123.139.192/27'

config ipset
	option name 'zoom_meet6'
	option family 'ipv6'
	list entry '2407:30C0::/32'
	list entry '2600:9000:2600::/48'
	list entry '2620:123:2000::/40'

config ipset
	option name 'zoom_phone'
	list entry '8.5.128.0/24'
	list entry '64.211.144.0/24'
	list entry '64.224.32.0/19'
	list entry '65.39.152.0/24'
	list entry '69.174.57.0/24'
	list entry '101.36.167.0/24'
	list entry '103.122.166.0/23'
	list entry '120.29.148.0/24'
	list entry '137.66.128.0/17'
	list entry '144.195.0.0/16'
	list entry '147.124.96.0/19'
	list entry '149.137.0.0/17'
	list entry '156.45.0.0/17'
	list entry '159.124.0.0/16'
	list entry '162.12.232.0/22'
	list entry '170.114.0.0/16'
	list entry '173.231.92.0/24'
	list entry '173.231.94.0/24'
	list entry '192.204.12.0/22'
	list entry '206.247.0.0/16'
	list entry '209.9.211.0/24'
	list entry '209.9.215.0/24'
	list entry '213.19.144.0/24'
	list entry '213.19.153.0/24'
	list entry '213.244.140.0/24'
	list entry '221.122.63.0/24'

config ipset
	option name 'zoom_phone6'
	option family 'ipv6'
	list entry '2620:123:2000::/40'

config rule
	option name 'Zoom Meetings and Webinars TCP'
	list proto 'tcp'
	list dest_port '443'
	list dest_port '8801-8802'
	list dest_ip '@zoom_meet'
	list dest_ip '@zoom_meet6'
	option class 'af41'

config rule
	option name 'Zoom Meetings and Webinars UDP'
	list proto 'udp'
	list dest_port '3478-3479'
	list dest_port '8801-8810'
	list dest_ip '@zoom_meet'
	list dest_ip '@zoom_meet6'
	option class 'af41'

config rule
	option name 'Zoom Phone TCP'
	list proto 'tcp'
	list dest_port '443'
	list dest_port '5091'
	list dest_ip '@zoom_phone'
	list dest_ip '@zoom_phone6'
	option class 'af41'

config rule
	option name 'Zoom Phone UDP'
	list proto 'udp'
	list dest_port '20000-64000'
	list dest_ip '@zoom_phone'
	list dest_ip '@zoom_phone6'
	option class 'ef'

config rule
	option name 'DNS'
	list proto 'tcp'
	list proto 'udp'
	list dest_port '53'
	list dest_port '853'
	list dest_port '5353'
	option class 'cs5'

config ipset
	option name 'DoH'
	list entry '8.8.8.8'			# Google
	list entry '8.8.4.4'			# Google
	list entry '1.1.1.1'			# Cloudflare
	list entry '1.0.0.1'			# Cloudflare
	list entry '9.9.9.9'			# Quad9 Secured
	list entry '149.112.112.112'	# Quad9 Secured
	list entry '9.9.9.11'			# Quad9 Secured w/ECS
	list entry '149.112.112.11'		# Quad9 Secured w/ECS

config ipset
	option name 'DoH6'
	list entry '2001:4860:4860::8888'	# Google
	list entry '2001:4860:4860::8844'	# Google
	list entry '2606:4700:4700::1111' 	# Cloudflare
	list entry '2606:4700:4700::1001'	# Cloudflare
	list entry '2620:fe::fe'			# Quad9 Secured
	list entry '2620:fe::9'				# Quad9 Secured
	list entry '2620:fe::11'			# Quad9 Secured w/ECS
	list entry '2620:fe::fe:11'			# Quad9 Secured w/ECS
	list entry '2a10:50c0::ad1:ff'		# AdGuard
	list entry '2a10:50c0::ad2:ff'		# AdGuard
	list entry '2a10:50c0::ded:ff'		# AdGuard Dedicated

config rule
	option name 'DoH'
	list proto 'tcp'
	list proto 'udp'
	list dest_port '443'
	list dest_ip '@DoH'
	list dest_ip '@DoH6'
	option class 'cs5'

config rule
	option name 'BOOTP/DHCP'
	option proto 'udp'
	list dest_port '67'
	list dest_port '68'
	option class 'cs5'

config rule
	option name 'NTP'
	option proto 'udp'
	option dest_port '123'
	option class 'cs5'

config rule
	option name 'SSH'
	option proto 'tcp'
	option dest_port '22'
	option class 'cs2'

config rule
	option name 'Xbox Cloud Gaming'
	option proto 'udp'
	list dest_ip '@xcloud'
	list dest_ip '@xcloud6'
	list dest_port '1000-1150'
	list dest_port '9002'
	option class 'af41'
	
config rule
	option name 'NVIDIA GFN'
	option proto 'udp'
	option family 'ipv4'
	list dest_ip '@GeForceNOWIPv4'
	option src_port '49003-49006'
	option class 'af41'

config rule
	option name 'Microsoft Teams Voice'
	option proto 'udp'
	option src_port '50000-50019'
	option dest_port '3478-3481'
	list dest_ip '@ms_teams'
	list dest_ip '@ms_teams6'
	option class 'ef'

config rule
	option name 'Microsoft Teams Video'
	option proto 'udp'
	option src_port '50020-50039'
	option dest_port '3478-3481'
	list dest_ip '@ms_teams'
	list dest_ip '@ms_teams6'
	option class 'af41'

config rule
	option name 'Microsoft Teams Sharing'
	option proto 'udp'
	option src_port '50040-50059'
	option dest_port '3478-3481'
	list dest_ip '@ms_teams'
	list dest_ip '@ms_teams6'
	option class 'af21'
	
config rule
	option name 'Discord VoIP'
	option proto 'udp'
	list dest_ip '66.22.196.0/22' # Rotterdam, EU - discord-nlrtm1-1
	list dest_ip '66.22.204.0/22' # Chicago, US - discord-uschi1-1
	list dest_ip '66.22.246.0/24' # Brazil, BR - discord-brcoa1-2
	option class 'ef'
	
config rule
	option name 'Apple FaceTime'
	option dest_port '16384-16387'
 	option dest_port '16393-16402'
	list dest_ip '17.0.0.0/8'
	option class 'af41'	
	
config rule
	option name 'ICMP'
	list proto 'icmp'
	list proto 'icmpv6'
	option class 'cs5'
	option enabled '0'

config rule # A rule which marks all non-HTTP UDP connections from a specific IP as cs4 and count new connection matches
	option name 'Game Console non-HTTP'
	option proto 'udp'
	list src_ip '192.168.1.100'
	list dest_port '!80'
	list dest_port '!443'
	option class 'cs4'
	option counter '1'
	option enabled '0'
